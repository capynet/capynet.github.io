<!DOCTYPE html>
<html lang="es-ES">

<!-- Mirrored from ecapy.com/formularios-multistep-con-ctools/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Dec 2016 15:36:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Capy |   Como hacer formularios multistep (wizard) con Ctools</title>
			<link rel="shortcut icon" href="../wp-content/uploads/2016/01/1454276298_globe-01.png" type="image/x-icon"/>
		<link rel="stylesheet" type="text/css" href="#">

	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="../xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://ecapy.com/wp-content/themes/prolog/js/html5.js"></script>
	<![endif]-->

	<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; Feed" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; RSS de los comentarios" href="../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; Como hacer formularios multistep (wizard) con Ctools RSS de los comentarios" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/ecapy.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-theme-sublime-text-css'  href='../wp-content/plugins/crayon-syntax-highlighter/themes/sublime-text/sublime-text2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='../wp-content/plugins/crayon-syntax-highlighter/fonts/monaco2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='thm-style-css'  href='../wp-content/themes/prolog/style1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='../wp-content/themes/prolog/css/font-awesome.min1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='quick-style-css'  href='../wp-content/themes/prolog/quick-style1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='themeum-preset-css'  href='../wp-content/themes/prolog/css/presets/preset31c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='redux-google-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans%7CRoboto+Slab%3A100%2C300%2C400%2C700&amp;ver=1454375832' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Error en conversion.js [Solución]' href='../error-en-conversion-js-solucion/index.html' />
<link rel='next' title='Cómo recuperar la clave root en MySQL [Solución]. A veces pasa :D' href='../como-recuperar-la-clave-root-en-mysql-solucion-a-veces-pasa-d/index.html' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../indexbd8b.html?p=1514' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embed01c0.json?url=http%3A%2F%2Fecapy.com%2Fformularios-multistep-con-ctools%2F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed4639?url=http%3A%2F%2Fecapy.com%2Fformularios-multistep-con-ctools%2F&amp;format=xml" />
<style type="text/css" title="dynamic-css" class="options-output">body, p{font-family:Open Sans;font-weight:normal;font-style:normal;color:#1a1a1a;font-size:16px;}h1, h2, h3, h4, h5, h6{font-family:Roboto Slab;font-weight:400;font-style:normal;color:#1a1a1a;}#navigation .navbar-nav > li > a, .navbar-main .dropdown-menu > li > a{font-family:Open Sans;font-weight:normal;font-style:normal;color:#777777;font-size:16px;}</style></head>

<body class="single single-post postid-1514 single-format-standard">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header header" role="banner">
			<div class="container">
				<div id="navigation" class="navbar navbar-default">
                    <div class="row">
                        <div class="col-sm-3">
        					<div class="navbar-header">
        						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        							<span class="icon-bar"></span>
        							<span class="icon-bar"></span>
        							<span class="icon-bar"></span>
        						</button>
        	                    <a class="navbar-brand" href="../index.html">
        	                    	<h1 class="logo-wrapper">
        		                    	Capy        		                    </h1>
        		                </a>
        					</div>
                        </div>

                        <div id="main-menu" class="col-sm-9">
                            <div class="hidden-xs">
                                <ul id="menu-principal" class="nav navbar-nav navbar-main"><li id="menu-item-2961" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2961"><a title="Drupal" href="../category/drupal/index.html"><span class="fa fa-drupal"></span>&nbsp;Drupal</a></li>
<li id="menu-item-2959" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2959"><a title="CSS y Maquetación" href="../category/css-y-maquetacion/index.html">CSS y Maquetación</a></li>
<li id="menu-item-2958" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2958"><a title="PHP" href="../category/php/index.html">PHP</a></li>
<li id="menu-item-2960" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2960"><a title="Javascript" href="../category/js/index.html">Javascript</a></li>
</ul>                            </div>
                        </div><!--/#main-menu-->

                        <div id="mobile-menu" class="visible-xs">
                            <div class="collapse navbar-collapse">
                                <ul id="menu-principal-1" class="nav navbar-nav"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2961"><a title="Drupal" href="../category/drupal/index.html"><span class="glyphicon drupal"></span>&nbsp;Drupal</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2959"><a title="CSS y Maquetación" href="../category/css-y-maquetacion/index.html">CSS y Maquetación</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2958"><a title="PHP" href="../category/php/index.html">PHP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2960"><a title="Javascript" href="../category/js/index.html">Javascript</a></li>
</ul>                            </div>
                        </div><!--/.#mobile-menu-->

                    </div><!--/.row--> 
				</div><!--/.container--> 
			</div>
		</header><!--/#header-->


    <section id="main" class="container">
        <div class="row">
            <div id="content" class="site-content col-md-9" role="main">

                
                    
                        <article id="post-1514" class="post-1514 post type-post status-publish format-standard has-post-thumbnail hentry category-programacion tag-drupal tag-drupal-7 tag-fapi">
    <header class="entry-header">

            <div class="entry-thumbnail">
            <img width="850" height="253" src="../wp-content/uploads/2015/07/drupal-header.jpg" class="img-responsive wp-post-image" alt="drupal-header" srcset="http://ecapy.com/wp-content/uploads/2015/07/drupal-header.jpg 850w, http://ecapy.com/wp-content/uploads/2015/07/drupal-header-300x89.jpg 300w, http://ecapy.com/wp-content/uploads/2015/07/drupal-header-768x229.jpg 768w" sizes="(max-width: 850px) 100vw, 850px" />        </div>
    
    </header> <!--/.entry-header -->

    <div class="clearfix post-content media">
        <div class="pull-left">
            <h4 class="post-format">
                <i class="fa fa-thumb-tack"></i>
            </h4>

        </div>
    

    <div class="media-body">
        <h2 class="entry-title">
            <a href="index.html" rel="bookmark">Como hacer formularios multistep (wizard) con Ctools</a>
                    </h2> <!-- //.entry-title -->

        <div class="clearfix entry-meta">
            <ul>
                                <li class="author"> <i class="fa fa-user"></i> <a href="../author/capynet/index.html" title="Entradas de capynet" rel="author">capynet</a></li> 
                
                                <li class="publish-date"><i class="fa fa-calendar"></i><time class="entry-date" datetime="2012-05-17T00:15:59+00:00">17 May,  2012</time></li>  
                
                                <li class="category"><i class="fa fa-folder-open-o"></i><a href="../category/programacion/index.html" rel="category tag">Programación</a></li>
                                
                                <li class="tag"><i class="fa fa-tags"></i><a href="../tag/drupal/index.html" rel="tag">Drupal</a>, <a href="../tag/drupal-7/index.html" rel="tag">Drupal 7</a>, <a href="../tag/fapi/index.html" rel="tag">FAPI</a><br /> </li>
                
                 
                                    <li class="comments-link">
                        <i class="fa fa-comments-o"></i> <a href="index.html#comments">2 comments</a>                    </li>
                                
                                    <li class="edit-link">
                                             </li>
                            </ul>
        </div> <!--/.entry-meta -->

        <div class="entry-summary">
            <p style="text-align: left;"><a href="http://drupal.org/project/ctools" target="_blank">Chaos tools</a> para muchos no es mas que una dependencia de <a href="http://drupal.org/project/panels" target="_blank">Panels</a>, <a href="http://drupal.org/project/views" target="_blank">Views</a>, <a href="http://drupal.org/project/features" target="_blank">Features </a>y muchos otros y fabulosos módulos mas. Pero (Gran pero), Ctools <em>per se</em> es un modulo increíblemente útil para nosotros mismos.</p>
<p style="text-align: left;">Bueno vamos a lo que vamos. Acá les dejo la idea de lo que vamos a hacer:</p>
<p style="text-align: left;"><strong>Tengo un formulario que necesita recoger tres datos de un usuario, y me parece que es mucha información para pedirla toda junta así que vamos a hacerlo en tres pasos distintos.</strong></p>
<p style="text-align: center;"><img class="aligncenter size-full wp-image-1515" title="Form wizard look" src="../wp-content/uploads/2012/05/form-wizard-splash.png" alt="" width="696" height="191" srcset="http://ecapy.com/wp-content/uploads/2012/05/form-wizard-splash.png 696w, http://ecapy.com/wp-content/uploads/2012/05/form-wizard-splash-300x82.png 300w" sizes="(max-width: 696px) 100vw, 696px" /></p>
<p style="text-align: left;">Para hacer este wizard vamos a usar un formulario normal pero separado en 3 funciones, y dos de las herramientas (plugins) que tiene Ctools. La primera es obviamente &#8220;<strong>Wizard</strong>&#8221; y para la persistencia de los datos entre steps usaremos &#8220;<strong>object-cache</strong>&#8220;.</p>
<p style="text-align: left;">Antes la estructura:</p>
<ul>
<li>Necesitamos hacer un item de menú con hook_menu() que nos lleve a una función que es la que va a manejar la batuta.</li>
<li>3 mini funciones para manejar &#8220;<strong>object-cache</strong>&#8220;</li>
<li>3 formularios/funciones para declarar el contenido de cada uno de los step.</li>
</ul>
<p style="text-align: left;">Hagamos lo:</p>
<p style="text-align: left;"><span style="text-decoration: underline;">Primero</span>: el menú y el callback del menú:</p>
<p></p>
		<div id="crayon-5844377938211870261169" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php function ctools_multistep_menu() { $items['ctools_multistep/example_multistep_form'] = array( 'title' =&gt; 'Ejemplo de un wizard con ctools',
    'page callback' =&gt; 'wizard_callback',
    'access callback' =&gt; TRUE,
    'type' =&gt; MENU_CALLBACK,
  );

  return $items;
}

function wizard_callback($step = NULL) {
 $form_info = array(
    'id' =&gt; 'example_multistep_form',

    'path' =&gt; "ctools_multistep/example_multistep_form/%step",
    'return path' =&gt; "",

    'show trail' =&gt; TRUE,
    'show back' =&gt; TRUE,

    'next callback' =&gt; 'callback_paso_siguiente',
    'finish callback' =&gt; 'callback_paso_final',

    'forms' =&gt; array(
      'primer_formulario' =&gt; array(
        'form id' =&gt; 'primer_formulario',
        'title' =&gt; 'Primer paso',
        'include' =&gt; drupal_get_path("module", "ctools_multistep") . '/formularios.inc',
      ),
      'segundo_formulario' =&gt; array(
        'form id' =&gt; 'segundo_formulario',
        'title' =&gt; 'Segundo paso',
        'include' =&gt; drupal_get_path("module", "ctools_multistep") . '/formularios.inc',
      ),
      'tercer_formulario' =&gt; array(
        'form id' =&gt; 'tercer_formulario',
        'title' =&gt; 'Tercer paso',
        'include' =&gt; drupal_get_path("module", "ctools_multistep") . '/formularios.inc',
      ),
    ),
  );

  global $user;
  $object_id = "ctools_multistep_de_ejemplo_" . $user-&gt;uid;

  if (empty($step)) {
    clean_datos($object_id);
    $step = 'primer_formulario';
  }

  $object = get_datos($object_id);

  $form_state = array(
    'object_id' =&gt; $object_id,
    'object' =&gt; &amp;$object,
  );

  ctools_include('wizard');
  $form = ctools_wizard_multistep_form($form_info, $step, $form_state);
  return drupal_render($form);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-5844377938211870261169-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-2">2</div><div class="crayon-num" data-line="crayon-5844377938211870261169-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-4">4</div><div class="crayon-num" data-line="crayon-5844377938211870261169-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-6">6</div><div class="crayon-num" data-line="crayon-5844377938211870261169-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-8">8</div><div class="crayon-num" data-line="crayon-5844377938211870261169-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-10">10</div><div class="crayon-num" data-line="crayon-5844377938211870261169-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-12">12</div><div class="crayon-num" data-line="crayon-5844377938211870261169-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-14">14</div><div class="crayon-num" data-line="crayon-5844377938211870261169-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-16">16</div><div class="crayon-num" data-line="crayon-5844377938211870261169-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-18">18</div><div class="crayon-num" data-line="crayon-5844377938211870261169-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-20">20</div><div class="crayon-num" data-line="crayon-5844377938211870261169-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-22">22</div><div class="crayon-num" data-line="crayon-5844377938211870261169-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-24">24</div><div class="crayon-num" data-line="crayon-5844377938211870261169-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-26">26</div><div class="crayon-num" data-line="crayon-5844377938211870261169-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-28">28</div><div class="crayon-num" data-line="crayon-5844377938211870261169-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-30">30</div><div class="crayon-num" data-line="crayon-5844377938211870261169-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-32">32</div><div class="crayon-num" data-line="crayon-5844377938211870261169-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-34">34</div><div class="crayon-num" data-line="crayon-5844377938211870261169-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-36">36</div><div class="crayon-num" data-line="crayon-5844377938211870261169-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-38">38</div><div class="crayon-num" data-line="crayon-5844377938211870261169-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-40">40</div><div class="crayon-num" data-line="crayon-5844377938211870261169-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-42">42</div><div class="crayon-num" data-line="crayon-5844377938211870261169-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-44">44</div><div class="crayon-num" data-line="crayon-5844377938211870261169-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-46">46</div><div class="crayon-num" data-line="crayon-5844377938211870261169-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-48">48</div><div class="crayon-num" data-line="crayon-5844377938211870261169-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-50">50</div><div class="crayon-num" data-line="crayon-5844377938211870261169-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-52">52</div><div class="crayon-num" data-line="crayon-5844377938211870261169-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-54">54</div><div class="crayon-num" data-line="crayon-5844377938211870261169-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-56">56</div><div class="crayon-num" data-line="crayon-5844377938211870261169-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-58">58</div><div class="crayon-num" data-line="crayon-5844377938211870261169-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938211870261169-60">60</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5844377938211870261169-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">ctools_multistep_menu</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">$items</span><span class="crayon-sy">[</span><span class="crayon-s">'ctools_multistep/example_multistep_form'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'title'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Ejemplo de un wizard con ctools'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'page callback'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'wizard_callback'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'access callback'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'type'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">MENU_CALLBACK</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-6">&nbsp;</div><div class="crayon-line" id="crayon-5844377938211870261169-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$items</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-8"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5844377938211870261169-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-10"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">wizard_callback</span><span class="crayon-sy">(</span><span class="crayon-v">$step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5844377938211870261169-11"><span class="crayon-h"> </span><span class="crayon-v">$form_info</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'example_multistep_form'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'path'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep/example_multistep_form/%step"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'return path'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-16">&nbsp;</div><div class="crayon-line" id="crayon-5844377938211870261169-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'show trail'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'show back'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'next callback'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'callback_paso_siguiente'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'finish callback'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'callback_paso_final'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-22">&nbsp;</div><div class="crayon-line" id="crayon-5844377938211870261169-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'forms'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'primer_formulario'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5844377938211870261169-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'form id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'primer_formulario'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'title'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Primer paso'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'include'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">drupal_get_path</span><span class="crayon-sy">(</span><span class="crayon-s">"module"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'/formularios.inc'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'segundo_formulario'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'form id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'segundo_formulario'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'title'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Segundo paso'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'include'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">drupal_get_path</span><span class="crayon-sy">(</span><span class="crayon-s">"module"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'/formularios.inc'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'tercer_formulario'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5844377938211870261169-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'form id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'tercer_formulario'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'title'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Tercer paso'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'include'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">drupal_get_path</span><span class="crayon-sy">(</span><span class="crayon-s">"module"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-s">'/formularios.inc'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-40"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938211870261169-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938211870261169-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$object_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep_de_ejemplo_"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-o">-&gt;</span><span class="crayon-i">uid</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-44">&nbsp;</div><div class="crayon-line" id="crayon-5844377938211870261169-45"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">empty</span><span class="crayon-sy">(</span><span class="crayon-v">$step</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">clean_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$object_id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938211870261169-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'primer_formulario'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-48"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5844377938211870261169-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-50"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$object</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$object_id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938211870261169-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-52"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$form_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5844377938211870261169-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'object_id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">$object_id</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'object'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">$object</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5844377938211870261169-55"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-56">&nbsp;</div><div class="crayon-line" id="crayon-5844377938211870261169-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">ctools_include</span><span class="crayon-sy">(</span><span class="crayon-s">'wizard'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-58"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$form</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ctools_wizard_multistep_form</span><span class="crayon-sy">(</span><span class="crayon-v">$form_info</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$form_state</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938211870261169-59"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-e">drupal_render</span><span class="crayon-sy">(</span><span class="crayon-v">$form</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938211870261169-60"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Como pueden ver, el item de menú no es mas que una URL normal.</p>
<p>Ahora bien. En la función principal podemos ver como definimos inicialmente un array normalito, y es en el en donde definimos las características del wizard:</p>
<p><span style="color: #993300;">&#8216;id&#8217; =&gt; &#8216;example_multistep_form&#8217;</span><br />
<strong>id</strong> <span style="color: #999999;">(string)</span> es el nombre que va a tener el wizard y es obligatorio poner uno</p>
<p><span style="color: #993300;">&#8216;path&#8217; =&gt; &#8220;ctools_multistep/example_multistep_form/%step&#8221;,</span><br />
<strong>path</strong><span style="color: #999999;"> (url)</span> es la URL que definimos en el hook_menu() mas &#8220;%step&#8221;. y es la URL que va a usar Ctools para ir poniendo el step actual en la arra de direcciones de nuestro navegador.</p>
<p><span style="color: #993300;">&#8216;return path&#8217; =&gt; &#8220;&lt;front&gt;&#8221;</span><br />
<strong>return path</strong> <span style="color: #999999;">(url)</span> es la URL a la que queremos enviar al usuario cuando este haya completado el formulario. en mi caso lo quiero mandar a la home</p>
<p><span style="color: #993300;">&#8216;show trail&#8217; =&gt; TRUE</span><br />
<strong>show trail</strong><span style="color: #999999;"> (bool)</span> indica a wizard que queremos que se muestre el breadcrumb de cada uno de los pasos.</p>
<p><span style="color: #993300;">&#8216;show back&#8217; =&gt; TRUE</span><br />
<strong>show back</strong><span style="color: #999999;"> (bool)</span> indica si queremos dejar que un usuario vuelva a pantallas anteriores. si está en TRUE muestra el botón con dicho fin.</p>
<p><span style="color: #993300;">&#8216;next callback&#8217; =&gt; &#8216;callback_paso_siguiente&#8217;</span><br />
<strong>next callback</strong><span style="color: #999999;"> (function name)</span> indica cual es la función que se debe ejecutar cada vez que pasemos de un formulario al siguiente. y es en esta funcion en la que vamos a ir guardando el estado actual del usuario.</p>
<p><span style="color: #993300;">&#8216;finish callback&#8217; =&gt; &#8216;callback_paso_final&#8217;</span><br />
<strong>finish callback</strong> <span style="color: #999999;">(function name)</span> indica cual es la función que se debe ejecutar una vez que el usuario haya completado el formulario. Aquí es donde vamos a guardar de forma permanente los datos del formulario y a limpiar los datos temporales.</p>
<p><span style="color: #993300;">&#8216;forms&#8217; =&gt; array(</span><br />
<span style="color: #993300;"> &#8216;primer_formulario&#8217; =&gt; array(</span><br />
<span style="color: #993300;"> &#8216;form id&#8217; =&gt; &#8216;primer_formulario&#8217;,</span><br />
<span style="color: #993300;"> &#8216;title&#8217; =&gt; &#8216;Primer paso&#8217;,</span><br />
<span style="color: #993300;"> &#8216;include&#8217; =&gt; drupal_get_path(&#8220;module&#8221;, &#8220;ctools_multistep&#8221;) . &#8216;/formularios.inc&#8217;,</span><br />
<span style="color: #993300;"> ),</span><br />
<span style="color: #993300;"> &#8216;segundo_formulario&#8217; =&gt; array(<br />
</span><span style="color: #993300;"> &#8216;form id&#8217; =&gt; &#8216;segundo_formulario&#8217;,<br />
</span><span style="color: #993300;"> &#8216;title&#8217; =&gt; &#8216;Segundo paso&#8217;,<br />
</span><span style="color: #993300;"> &#8216;include&#8217; =&gt; drupal_get_path(&#8220;module&#8221;, &#8220;ctools_multistep&#8221;) . &#8216;/formularios.inc&#8217;,<br />
</span><span style="color: #993300;"> ),<br />
</span><span style="color: #993300;">)</span></p>
<p>Por ultimo en <strong>forms</strong><span style="color: #999999;"> (array)</span> indicaremos cuales son los formularios que se van a usar en cada paso, el titulo que van a mostrar en el breadcrumb y si tuviéramos esta función en otro archivo, la ruta en la que se aloja.</p>
<p>Nos quedan dos cosas en el formulario. La primera es definir el nombre del objeto que va a almacenar de forma temporal los datos del usuario, ver si ver si vamos a reiniciar el formulario (en el caso de que el usuario acceda nuevamente al formulario) e inicializar los datos del usuario (ahora lo explico).</p>
		<div id="crayon-5844377938225269359338" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php global $user; $object_id = "ctools_multistep_de_ejemplo_" . $user-&gt;uid;

if (empty($step)) {
  clean_datos($object_id);
  $step = 'primer_formulario';
}

  $object = get_datos($object_id);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-5844377938225269359338-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938225269359338-2">2</div><div class="crayon-num" data-line="crayon-5844377938225269359338-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938225269359338-4">4</div><div class="crayon-num" data-line="crayon-5844377938225269359338-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938225269359338-6">6</div><div class="crayon-num" data-line="crayon-5844377938225269359338-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938225269359338-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5844377938225269359338-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php </span><span class="crayon-m">global</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">$object_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep_de_ejemplo_"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">$user</span><span class="crayon-o">-&gt;</span><span class="crayon-i">uid</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938225269359338-2">&nbsp;</div><div class="crayon-line" id="crayon-5844377938225269359338-3"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">empty</span><span class="crayon-sy">(</span><span class="crayon-v">$step</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938225269359338-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">clean_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$object_id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377938225269359338-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'primer_formulario'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938225269359338-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5844377938225269359338-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5844377938225269359338-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$object</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$object_id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>La segunda cosa que nos queda en esta función es claramente generar el wizard:</p>
		<div id="crayon-584437793822a838077927" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php $form_state = array( 'object_id' =&gt; $object_id, 'object' =&gt; &amp;$object );

ctools_include('wizard');
$form = ctools_wizard_multistep_form($form_info, $step, $form_state);
return drupal_render($form);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-584437793822a838077927-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822a838077927-2">2</div><div class="crayon-num" data-line="crayon-584437793822a838077927-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822a838077927-4">4</div><div class="crayon-num" data-line="crayon-584437793822a838077927-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-584437793822a838077927-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-i">php</span><span class="crayon-h"> </span><span class="crayon-v">$form_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'object_id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">$object_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'object'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">$object</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822a838077927-2">&nbsp;</div><div class="crayon-line" id="crayon-584437793822a838077927-3"><span class="crayon-e">ctools_include</span><span class="crayon-sy">(</span><span class="crayon-s">'wizard'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822a838077927-4"><span class="crayon-v">$form</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ctools_wizard_multistep_form</span><span class="crayon-sy">(</span><span class="crayon-v">$form_info</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$form_state</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-584437793822a838077927-5"><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-e">drupal_render</span><span class="crayon-sy">(</span><span class="crayon-v">$form</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>mmmbueeeeno, tenemos declarado el formulario, un par de funciones para el avance y finalización y hacemos uso de clean_datos() y get_datos(). pues eso es lo que sigue. definir estas funciones:</p>
<p>set_datos(), get_datos() y clean_datos() no son mas que unos wrappers que guardan recuperan y eliminan la información que el usuario va rellenando:</p>
		<div id="crayon-584437793822f921178796" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php function set_datos($id, $object) { ctools_include('object-cache'); ctools_object_cache_set('ctools_multistep', $id, $object); } function get_datos($id) { ctools_include('object-cache'); $object = ctools_object_cache_get('ctools_multistep', $id); //creamos un objeto vacío para empezar if (!$object) { $object = new stdClass; $object-&gt;dia = NULL;
    $object-&gt;nombre = "";
    $object-&gt;apellido = "";
  }

  return $object;
}

function clean_datos($id) {
  ctools_include('object-cache');
  ctools_object_cache_clear('ctools_multistep', $id);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-584437793822f921178796-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-2">2</div><div class="crayon-num" data-line="crayon-584437793822f921178796-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-4">4</div><div class="crayon-num" data-line="crayon-584437793822f921178796-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-6">6</div><div class="crayon-num" data-line="crayon-584437793822f921178796-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-8">8</div><div class="crayon-num" data-line="crayon-584437793822f921178796-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-10">10</div><div class="crayon-num" data-line="crayon-584437793822f921178796-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-584437793822f921178796-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-584437793822f921178796-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">set_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$object</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">ctools_include</span><span class="crayon-sy">(</span><span class="crayon-s">'object-cache'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">ctools_object_cache_set</span><span class="crayon-sy">(</span><span class="crayon-s">'ctools_multistep'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$object</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">get_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$id</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">ctools_include</span><span class="crayon-sy">(</span><span class="crayon-s">'object-cache'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">$object</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ctools_object_cache_get</span><span class="crayon-sy">(</span><span class="crayon-s">'ctools_multistep'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//creamos un objeto vacío para empezar if (!$object) { $object = new stdClass; $object-&gt;dia = NULL;</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$object</span><span class="crayon-o">-&gt;</span><span class="crayon-i">nombre</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-584437793822f921178796-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">$object</span><span class="crayon-o">-&gt;</span><span class="crayon-i">apellido</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-584437793822f921178796-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$object</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-584437793822f921178796-7"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-8">&nbsp;</div><div class="crayon-line" id="crayon-584437793822f921178796-9"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">clean_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$id</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">ctools_include</span><span class="crayon-sy">(</span><span class="crayon-s">'object-cache'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-584437793822f921178796-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">ctools_object_cache_clear</span><span class="crayon-sy">(</span><span class="crayon-s">'ctools_multistep'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$id</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-584437793822f921178796-12"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Con las pequeñas funciones de <strong>object-cache</strong> vamos metiendo la información que el usuario complete cada vez que se le de a &#8220;<strong>Continuar</strong>&#8221; dentro del objeto:</p>
		<div id="crayon-5844377938233437528253" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php
function callback_paso_siguiente(&amp;$form_state) {
  set_datos($form_state['object_id'], $form_state['object']);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-5844377938233437528253-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938233437528253-2">2</div><div class="crayon-num" data-line="crayon-5844377938233437528253-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377938233437528253-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5844377938233437528253-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938233437528253-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">callback_paso_siguiente</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">$form_state</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5844377938233437528253-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">set_datos</span><span class="crayon-sy">(</span><span class="crayon-v">$form_state</span><span class="crayon-sy">[</span><span class="crayon-s">'object_id'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$form_state</span><span class="crayon-sy">[</span><span class="crayon-s">'object'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377938233437528253-4"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Y cuando el usuario complete el formulario vamos a usar la función que definimos en &#8220;finish callback&#8221; para dejarle un mensaje en pantalla al usuario (lo mas lógico seria guardarlos de forma permanente pero esta es una demo XD) y limpiar los datos;</p>
<p><img class="aligncenter size-full wp-image-1518" title="wizard-step-2" src="../wp-content/uploads/2012/05/wizard-step-2.png" alt="" width="434" height="143" srcset="http://ecapy.com/wp-content/uploads/2012/05/wizard-step-2.png 434w, http://ecapy.com/wp-content/uploads/2012/05/wizard-step-2-300x99.png 300w" sizes="(max-width: 434px) 100vw, 434px" /></p>
<p><img class="aligncenter size-full wp-image-1519" title="wizard-step-3" src="../wp-content/uploads/2012/05/wizard-step-3.png" alt="" width="448" height="162" srcset="http://ecapy.com/wp-content/uploads/2012/05/wizard-step-3.png 448w, http://ecapy.com/wp-content/uploads/2012/05/wizard-step-3-300x108.png 300w" sizes="(max-width: 448px) 100vw, 448px" /></p>
<p>y cuando el wizard nos mande a la home vamos a ver:</p>
<p><img class="aligncenter size-full wp-image-1516" title="wizard-result" src="../wp-content/uploads/2012/05/wizard-result.png" alt="" width="446" height="77" srcset="http://ecapy.com/wp-content/uploads/2012/05/wizard-result.png 446w, http://ecapy.com/wp-content/uploads/2012/05/wizard-result-300x52.png 300w" sizes="(max-width: 446px) 100vw, 446px" /></p>
<p>Les dejo un descargable con este wizard de ejemplo para que puedan verlo en detalle.</p>
<p><a class="descargar" href="../wp-content/uploads/2012/05/ctools_multistep.rar">Descargar</a></p>
<p>Chau!</p>
        </div> <!-- //.entry-summary -->
            </div>
 

    </div>

</article> <!--/#post-->
                                                     <div class="clearfix post-navigation">
                                <span class="btn-style previous-post pull-left"><a href="../error-en-conversion-js-solucion/index.html" rel="prev"><i class="fa fa-long-arrow-left"></i> previous article</a></span>                                 <span class="btn-style next-post pull-right"><a href="../como-recuperar-la-clave-root-en-mysql-solucion-a-veces-pasa-d/index.html" rel="next">next article <i class="fa fa-long-arrow-right"></i></a></span>                            </div> <!-- .post-navigation -->
                                            
                        <div id="comments" class="comments-area comments">
            <h3 class="comments-title">
            2 Comments        </h3>

        <ul class="comment-list">

            		<li class="comment even thread-even depth-1" id="li-comment-582">
			<div id="comment-582" class="comment-body media">
				
					<div class="comment-avartar pull-left">
						<img alt='' src='http://0.gravatar.com/avatar/cd85dda23462ccb1310374c228fd3f99?s=80&amp;d=identicon&amp;r=g' srcset='http://0.gravatar.com/avatar/cd85dda23462ccb1310374c228fd3f99?s=160&amp;d=identicon&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' />					</div>
					<div class="comment-context media-body">
						<div class="comment-head">
							<span class="comment-author">Drupalist</span>							<span class="comment-date">23/08/2013</span>

														<span class="comment-reply">
															</span>
						</div>

						
						<div class="comment-content">
							<p>¿Qué ocurre con la persistencia de datos en la caché cuando 2 usuarios anónimos simultáneos intentan cubrir el formulario?. Según el código superior, en ambos casos se asignaría el mismo object_id al objeto que guarda los datos del formulario en la caché para ambos usuarios, con lo cuál los datos almacenados serían incorrectos para ambos usuarios, ¿no?. ¿Qué mecanismo proporciona ctools para gestionar estos casos?.</p>
						</div>
					</div>
				
			</div>
		<ul class="children">
		<li class="comment byuser comment-author-capynet bypostauthor odd alt depth-2" id="li-comment-583">
			<div id="comment-583" class="comment-body media">
				
					<div class="comment-avartar pull-left">
						<img alt='' src='http://1.gravatar.com/avatar/d6c12e6d5158c740bf4e9dcddbf667f6?s=80&amp;d=identicon&amp;r=g' srcset='http://1.gravatar.com/avatar/d6c12e6d5158c740bf4e9dcddbf667f6?s=160&amp;d=identicon&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' />					</div>
					<div class="comment-context media-body">
						<div class="comment-head">
							<span class="comment-author"><a href='../index.html' rel='external nofollow' class='url'>Capy</a></span>							<span class="comment-date">28/08/2013</span>

														<span class="comment-reply">
															</span>
						</div>

						
						<div class="comment-content">
							<p>Anda, tenes razón.  una solución podría ser setear una cookie con un valor único para cada usuario y usar este valor para armar el $object_id:</p>
<p></p>
		<div id="crayon-5844377939a36780904282" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt;?
if (!isset($_COOKIE["object_id"])) {
  $object_id = "ctools_multistep_de_ejemplo_" . md5(rand(0, 99999999999));
  setcookie("object_id", $object_id, time() + 3600, "/", "example.com");
}
else {
  $object_id = $_COOKIE["object_id"];
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-5844377939a36780904282-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377939a36780904282-2">2</div><div class="crayon-num" data-line="crayon-5844377939a36780904282-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377939a36780904282-4">4</div><div class="crayon-num" data-line="crayon-5844377939a36780904282-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377939a36780904282-6">6</div><div class="crayon-num" data-line="crayon-5844377939a36780904282-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5844377939a36780904282-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5844377939a36780904282-1"><span class="crayon-ta">&lt;?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377939a36780904282-2"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-k ">isset</span><span class="crayon-sy">(</span><span class="crayon-v">$_COOKIE</span><span class="crayon-sy">[</span><span class="crayon-s">"object_id"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5844377939a36780904282-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$object_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ctools_multistep_de_ejemplo_"</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">md5</span><span class="crayon-sy">(</span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">99999999999</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377939a36780904282-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">setcookie</span><span class="crayon-sy">(</span><span class="crayon-s">"object_id"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">$object_id</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3600</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"/"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"example.com"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5844377939a36780904282-5"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377939a36780904282-6"><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5844377939a36780904282-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">$object_id</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$_COOKIE</span><span class="crayon-sy">[</span><span class="crayon-s">"object_id"</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5844377939a36780904282-8"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
						</div>
					</div>
				
			</div>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
        </ul><!-- .comment-list -->

        
                <p class="no-comments">:).</p>
        
    
    </div>                                            
                    
                        
            </div> <!-- #content -->

            <div id="sidebar" class="col-md-3" role="complementary">
                

	<div class="my-profile clearfix">
		<div class="profile-bg">
						<img class="img-responsive" src="../wp-content/uploads/2016/01/14567-brick-wall-and-wood-floor-1920x1200-abstract-wallpaper.jpg">
			
						<div class="profile-img">
				<img class="img-responsive" src="../wp-content/uploads/2016/01/IMG-20150521-WA0007-1.jpg">
			</div>
					</div>

		<div class="profile-desc">
							<h2>Capy (Marcelo Tosco)</h2>
										<span>Desarrollador web</span>
									<p>Hola!. en mi blog casi siempre escribo sobre informática, pero no te extrañes si algún día aparece un post que no tenga nada que ver a lo que estés acostumbrado ;)</p>
					</div>

		
<div class="social-share">
	
	<ul>
		
			
			<li><a class="twitter" href="http://twitter.com/capynet" target="_blank" ><i class="fa fa-twitter"></i></a></li>
									<li><a class="linkedin" href="https://es.linkedin.com/in/capynet" target="_blank"><i class="fa fa-linkedin"></i></a></li>
											 
		
	</ul>
	
</div>




	</div>

                <div class="sidebar-inner">
                    <aside class="widget-area">
                                            </aside>
                </div>
            </div> <!-- #sidebar -->

        </div> <!-- .row -->
    </section> <!-- .container -->


        <footer id="footer">
        <div class="container">
            <div class="footer">
                <div class="row">
                                            <div class="col-sm-6">
                          <a href="http://asociaciondrupal.es/" target="_blank"><img class="alignnone size-full wp-image-3123" src="../wp-content/uploads/2016/01/miembro-aed_150x75.jpg" alt="miembro-aed_150x75" width="150" height="75" /></a>                        </div>
                    
                                    </div>
            </div>
        </div>
    </footer><!--/#footer-->
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-238596-8', 'auto');
  ga('send', 'pageview');

</script>
<link rel='stylesheet' id='crayon-css'  href='../wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/imagesloaded.min55a0.js?ver=3.2.0'></script>
<script type='text/javascript' src='../wp-includes/js/masonry.mind617.js?ver=3.3.2'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/bootstrap.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/jquery.prettyPhoto1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/jquery.countdown.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/main1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/ecapy.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Presiona %s para copiar y %s para pegar","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min2f6a.js?ver=_2.7.2_beta'></script>
</body>

<!-- Mirrored from ecapy.com/formularios-multistep-con-ctools/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Dec 2016 15:36:57 GMT -->
</html>