<!DOCTYPE html>
<html lang="es-ES">

<!-- Mirrored from ecapy.com/entender-y-crear-una-entidad/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Dec 2016 15:38:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Capy |   Entidades en Drupal: 1) Entender y crear una entidad</title>
			<link rel="shortcut icon" href="../wp-content/uploads/2016/01/1454276298_globe-01.png" type="image/x-icon"/>
		<link rel="stylesheet" type="text/css" href="#">

	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="../xmlrpc.php">
	<!--[if lt IE 9]>
	<script src="http://ecapy.com/wp-content/themes/prolog/js/html5.js"></script>
	<![endif]-->

	<link rel='dns-prefetch' href='http://fonts.googleapis.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; Feed" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; RSS de los comentarios" href="../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Capy &raquo; Entidades en Drupal: 1) Entender y crear una entidad RSS de los comentarios" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/ecapy.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='crayon-theme-sublime-text-css'  href='../wp-content/plugins/crayon-syntax-highlighter/themes/sublime-text/sublime-text2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='../wp-content/plugins/crayon-syntax-highlighter/fonts/monaco2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='thm-style-css'  href='../wp-content/themes/prolog/style1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='../wp-content/themes/prolog/css/font-awesome.min1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='quick-style-css'  href='../wp-content/themes/prolog/quick-style1c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='themeum-preset-css'  href='../wp-content/themes/prolog/css/presets/preset31c9b.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='redux-google-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans%7CRoboto+Slab%3A100%2C300%2C400%2C700&amp;ver=1454375832' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/jquery/jqueryb8ff.js?ver=1.12.4'></script>
<script type='text/javascript' src='../wp-includes/js/jquery/jquery-migrate.min330a.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Drupal 7: Convertir los label del formulario de login en placeholders (HTML5)' href='../drupal-7-convertir-los-label-del-formulario-de-login-en-placeholders-html5/index.html' />
<link rel='next' title='Entidades en Drupal: 2) Trabajar con la entidad' href='../trabajar-con-la-entidad/index.html' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="index.html" />
<link rel='shortlink' href='../index939a.html?p=1891' />
<link rel="alternate" type="application/json+oembed" href="../wp-json/oembed/1.0/embed2853.json?url=http%3A%2F%2Fecapy.com%2Fentender-y-crear-una-entidad%2F" />
<link rel="alternate" type="text/xml+oembed" href="../wp-json/oembed/1.0/embed0eda?url=http%3A%2F%2Fecapy.com%2Fentender-y-crear-una-entidad%2F&amp;format=xml" />
<style type="text/css" title="dynamic-css" class="options-output">body, p{font-family:Open Sans;font-weight:normal;font-style:normal;color:#1a1a1a;font-size:16px;}h1, h2, h3, h4, h5, h6{font-family:Roboto Slab;font-weight:400;font-style:normal;color:#1a1a1a;}#navigation .navbar-nav > li > a, .navbar-main .dropdown-menu > li > a{font-family:Open Sans;font-weight:normal;font-style:normal;color:#777777;font-size:16px;}</style></head>

<body class="single single-post postid-1891 single-format-standard">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header header" role="banner">
			<div class="container">
				<div id="navigation" class="navbar navbar-default">
                    <div class="row">
                        <div class="col-sm-3">
        					<div class="navbar-header">
        						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        							<span class="icon-bar"></span>
        							<span class="icon-bar"></span>
        							<span class="icon-bar"></span>
        						</button>
        	                    <a class="navbar-brand" href="../index.html">
        	                    	<h1 class="logo-wrapper">
        		                    	Capy        		                    </h1>
        		                </a>
        					</div>
                        </div>

                        <div id="main-menu" class="col-sm-9">
                            <div class="hidden-xs">
                                <ul id="menu-principal" class="nav navbar-nav navbar-main"><li id="menu-item-2961" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-2961"><a title="Drupal" href="../category/drupal/index.html"><span class="fa fa-drupal"></span>&nbsp;Drupal</a></li>
<li id="menu-item-2959" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2959"><a title="CSS y Maquetación" href="../category/css-y-maquetacion/index.html">CSS y Maquetación</a></li>
<li id="menu-item-2958" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2958"><a title="PHP" href="../category/php/index.html">PHP</a></li>
<li id="menu-item-2960" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2960"><a title="Javascript" href="../category/js/index.html">Javascript</a></li>
</ul>                            </div>
                        </div><!--/#main-menu-->

                        <div id="mobile-menu" class="visible-xs">
                            <div class="collapse navbar-collapse">
                                <ul id="menu-principal-1" class="nav navbar-nav"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-2961 active"><a title="Drupal" href="../category/drupal/index.html"><span class="glyphicon drupal"></span>&nbsp;Drupal</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2959"><a title="CSS y Maquetación" href="../category/css-y-maquetacion/index.html">CSS y Maquetación</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2958"><a title="PHP" href="../category/php/index.html">PHP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2960"><a title="Javascript" href="../category/js/index.html">Javascript</a></li>
</ul>                            </div>
                        </div><!--/.#mobile-menu-->

                    </div><!--/.row--> 
				</div><!--/.container--> 
			</div>
		</header><!--/#header-->


    <section id="main" class="container">
        <div class="row">
            <div id="content" class="site-content col-md-9" role="main">

                
                    
                        <article id="post-1891" class="post-1891 post type-post status-publish format-standard has-post-thumbnail hentry category-drupal tag-drupal tag-drupal-7 tag-entities">
    <header class="entry-header">

            <div class="entry-thumbnail">
            <img width="850" height="253" src="../wp-content/uploads/2015/07/drupal-header.jpg" class="img-responsive wp-post-image" alt="drupal-header" srcset="http://ecapy.com/wp-content/uploads/2015/07/drupal-header.jpg 850w, http://ecapy.com/wp-content/uploads/2015/07/drupal-header-300x89.jpg 300w, http://ecapy.com/wp-content/uploads/2015/07/drupal-header-768x229.jpg 768w" sizes="(max-width: 850px) 100vw, 850px" />        </div>
    
    </header> <!--/.entry-header -->

    <div class="clearfix post-content media">
        <div class="pull-left">
            <h4 class="post-format">
                <i class="fa fa-thumb-tack"></i>
            </h4>

        </div>
    

    <div class="media-body">
        <h2 class="entry-title">
            <a href="index.html" rel="bookmark">Entidades en Drupal: 1) Entender y crear una entidad</a>
                    </h2> <!-- //.entry-title -->

        <div class="clearfix entry-meta">
            <ul>
                                <li class="author"> <i class="fa fa-user"></i> <a href="../author/capynet/index.html" title="Entradas de capynet" rel="author">capynet</a></li> 
                
                                <li class="publish-date"><i class="fa fa-calendar"></i><time class="entry-date" datetime="2013-02-18T18:40:07+00:00">18 Feb,  2013</time></li>  
                
                                <li class="category"><i class="fa fa-folder-open-o"></i><a href="../category/drupal/index.html" rel="category tag">Drupal</a></li>
                                
                                <li class="tag"><i class="fa fa-tags"></i><a href="../tag/drupal/index.html" rel="tag">Drupal</a>, <a href="../tag/drupal-7/index.html" rel="tag">Drupal 7</a>, <a href="../tag/entities/index.html" rel="tag">Entities</a><br /> </li>
                
                 
                                    <li class="comments-link">
                        <i class="fa fa-comments-o"></i> <a href="index.html#comments">4 comments</a>                    </li>
                                
                                    <li class="edit-link">
                                             </li>
                            </ul>
        </div> <!--/.entry-meta -->

        <div class="entry-summary">
            <p>Hasta ahora no había tenido que hacer entidades desde cero, por A o por B siempre voy por otros caminos, pero hoy si que me tocó hacer una y vi bastante difusas las cosas.<br />
Sabia la teoría de lo que era una entidad, un bundle y esas cosas, pero cuando me tuve que poner a hacer la entidad me las vi crudas un buen rato.</p>
<p>El problema se me dio básicamente en que los tutoriales y documentación que hay por ahí se centran en mostrar todo lo que se puede hacer de una sola vez, y bueno&#8230; no soy tan listo, me perdía en el código.</p>
<p>Pero ahora lo veo un poco mas claro y quiero explicarlo de la forma que me hubiera gustado que me lo transmitieran.</p>
<p>Voy a explicar en dos o tres artículos lo que hace falta saber sobre la implementacion de una entidad usando <a href="http://drupal.org/project/entity" target="_blank">Entity API</a> y tratando de aclarar bien bien donde acaba una funcionalidad y comienza otra.</p>
<p>Vamos allá.</p>
<p>Lo primero es lo primero. Estas leyendo esto posiblemente porque querés hacer entidades y entiendo que <a href="http://drupal.org/node/1261744" target="_blank">ya hiciste los deberes</a> y conoces los conceptos básicos así que no los voy a explicar. En su lugar vamos a aprender haciendo mini módulos que implementen las distintas funcionalidades.</p>
<h3>Creemos una entidad</h3>
<p>Para crear una entidad <strong>solo necesitas dos cosas</strong>:</p>
<ol>
<li>Es schema (futura tabla en la DB) para guardar los datos mínimos y necesarios y cualquier otro dato que quieras que esté relacionado a las entidades que estas creando.</li>
<li>Informar a Drupal que ese schema lo tiene que entender como una entidad.</li>
</ol>
<p><strong>TIP:</strong> Programaticamente hablando una entidad es un objeto. Eso es, nada mas que un objeto. No te preocupes de que tipo es, solo tenes que saber eso, que es un objeto.<br />
Este objeto tiene una capa de persistencia que es el schema. De ahí que solo haga falta definir un schema e informar al sistema sobre la nueva entidad.</p>
<p><strong>TIP2:</strong> Otra cosa que me descolocó hasta que me di cuenta de lo que acabo de comentar el el tip anterior es que: una entidad es un concepto abstracto y que las instancias (los objetos creados a partir de esa entidad) son los objetos reales y &#8220;tangibles&#8221;. Estas instancias son las que van a parar a la DB. Luego existen también los bundles pero ya nos vamos a complicar la vida con ese concepto en el próximos artículos.</p>
<p>Volviendo al tema:</p>
<h4>Schema:</h4>
<p>El schema no tiene nada de especial, lo único que necesita para funcionar es el identificador único para esta entidad (Compara esto al uid de un usuario, el nid de un nodo, etc.) y un field cualquiera <sup><a href="#one">*1</a></sup>.<br />
Entonces, si necesitáramos una entidad mega simple, nuestro schema se vería así:</p>
		<div id="crayon-58443808bfc64997624692" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php function entidad_simple_schema() { $schema['nombre_de_la_tabla'] = array( 'description' =&gt; 'Almacena instancias de la entidad',
    'fields' =&gt; array(
      'entityID' =&gt; array(
        'type' =&gt; 'serial',
        'not null' =&gt; TRUE,
        'description' =&gt; 'Identidicador unico de esta entidad.',
      ),
      'nombre' =&gt; array(
        'description' =&gt; 'Nombre de la instancia',
        'type' =&gt; 'varchar',
        'length' =&gt; 100,
        'not null' =&gt; TRUE,
        'default' =&gt; '',
      ),
    ),
    'primary key' =&gt; array('entityID'),
  );
  return $schema;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-58443808bfc64997624692-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-2">2</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-4">4</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-6">6</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-8">8</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-10">10</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-12">12</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-14">14</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-16">16</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc64997624692-18">18</div><div class="crayon-num" data-line="crayon-58443808bfc64997624692-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58443808bfc64997624692-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">entidad_simple_schema</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">$schema</span><span class="crayon-sy">[</span><span class="crayon-s">'nombre_de_la_tabla'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'description'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Almacena instancias de la entidad'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'fields'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'entityID'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'type'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'serial'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'not null'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'description'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Identidicador unico de esta entidad.'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'nombre'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'description'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'Nombre de la instancia'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'type'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'varchar'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'length'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'not null'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">TRUE</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'default'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'primary key'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">'entityID'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc64997624692-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$schema</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58443808bfc64997624692-19"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p></p>
<h4>Informar a Drupal:</h4>
<p>Para terminar de crear la entidad vamos a informar a Drupal usando el <a href="http://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_entity_info/7" target="_blank">hook_entity_info()</a></p>
		<div id="crayon-58443808bfc73856871347" class="crayon-syntax crayon-theme-sublime-text crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style=" margin-top: 12px; margin-bottom: 12px; ">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; ">
&lt; ?php function entidad_simple_entity_info() { $return = array( 'laEntidad' =&gt; array(
      'label' =&gt; t('La entidad'),
      'controller class' =&gt; 'EntityAPIController',
      'base table' =&gt; 'nombre_de_la_tabla',
      'entity keys' =&gt; array('id' =&gt; 'entityID'),
    ),

  );
  return $return;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style=""><div class="crayon-num" data-line="crayon-58443808bfc73856871347-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc73856871347-2">2</div><div class="crayon-num" data-line="crayon-58443808bfc73856871347-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc73856871347-4">4</div><div class="crayon-num" data-line="crayon-58443808bfc73856871347-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc73856871347-6">6</div><div class="crayon-num" data-line="crayon-58443808bfc73856871347-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc73856871347-8">8</div><div class="crayon-num" data-line="crayon-58443808bfc73856871347-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-58443808bfc73856871347-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style=" -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-58443808bfc73856871347-1"><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-e">php </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">entidad_simple_entity_info</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">$return</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-s">'laEntidad'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc73856871347-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'label'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">t</span><span class="crayon-sy">(</span><span class="crayon-s">'La entidad'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc73856871347-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'controller class'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'EntityAPIController'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc73856871347-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'base table'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'nombre_de_la_tabla'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc73856871347-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'entity keys'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">'id'</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">'entityID'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc73856871347-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-58443808bfc73856871347-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc73856871347-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-58443808bfc73856871347-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">return</span><span class="crayon-h"> </span><span class="crayon-v">$return</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-58443808bfc73856871347-10"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>Ese codigo que acabo de poner es la unidad mínima de información que necesita este hook para crear correctamente tu entidad.<br />
Este array es bastante claro:</p>
<table class="desglose-params">
<tbody>
<tr>
<td>laEntidad</td>
<td>Es el nombre de tu entidad, no tiene nada que ver con el nombre de la tabla que declaraste en el schema y puede ser el nombre que mas te guste.</td>
</tr>
<tr>
<td>label</td>
<td>Es la versión legible del nombre de tu entidad.</td>
</tr>
<tr>
<td>controller class</td>
<td>Es el nombre de la clase que se va a hacer cargo de gestionar todo lo relacionado con tu entidad. puntualmente &#8220;EntityAPIController&#8221; es la clase que nos proporciona Entity API, y es una versión bastante mas completa que la que nos proporciona Drupal en su core (DrupalDefaultEntityController).<br />
Es interesante este punto así que profundizo un poco mas:<br />
Sin entrar mucho en detalle, &#8220;controller class&#8221; designa al que se va a encargar de hacer CRUD sobre tu entidad, esto es, el que se va a encargar la lógica para insertar registros en la DB, obtenerlos, actualizarlos y borrarlos.<br />
En nuestro caso usamos la clase proporcionada por Entity API porque esta incorpora un montón de funcionalidades que SON BÁSICAS y que la clase que trae Drupal no incluye. Esto es harina de otro costal y no vamos a darle mas vueltas. solo quería que te quede claro el rol que ocupa esta clase.</td>
</tr>
<tr>
<td>base table</td>
<td>Bueno, es el schema que definimos antes, nada mas.</td>
</tr>
<tr>
<td>entity keys</td>
<td>En el schema teníamos que definir un identificador para las instancias de las entidades que se creen, pues es ese valor.</td>
</tr>
</tbody>
</table>
<p>Acá te dejo el código anterior metido en un modulo para que lo pruebes.</p>
<p><a class="descargar" title="Descargar ejemplo" href="../wp-content/uploads/2013/02/entidad_simple.zip">Descargar ejemplo</a></p>
<p>Aquí concluimos este articulo, el próximo vamos a hacer un modulo que haga algo con la entidad que acabamos de crear, que este modulo por si solo no hace nada.</p>
<p>Chau!</p>
<p id="one" class="referencia">*1: El field cualquiera es porque internamente cuando se hace un <a href="http://api.drupal.org/api/drupal/includes%21common.inc/function/drupal_write_record/7" target="_blank">drupal_write_record()</a> si no tiene aunque sea un field, descarta la operación ¬¬. En este ejemplo hice un field llamado &#8220;nombre&#8221; que nos va a venir bien.</p>
        </div> <!-- //.entry-summary -->
            </div>
 

    </div>

</article> <!--/#post-->
                                                     <div class="clearfix post-navigation">
                                <span class="btn-style previous-post pull-left"><a href="../drupal-7-convertir-los-label-del-formulario-de-login-en-placeholders-html5/index.html" rel="prev"><i class="fa fa-long-arrow-left"></i> previous article</a></span>                                 <span class="btn-style next-post pull-right"><a href="../trabajar-con-la-entidad/index.html" rel="next">next article <i class="fa fa-long-arrow-right"></i></a></span>                            </div> <!-- .post-navigation -->
                                            
                        <div id="comments" class="comments-area comments">
            <h3 class="comments-title">
            4 Comments        </h3>

        <ul class="comment-list">

            		<li class="pingback even thread-even depth-1" id="comment-629">
			<p>Pingback: <a href='../trabajar-con-la-entidad/index.html' rel='external nofollow' class='url'>Entidades en Drupal: 2) Trabajar con la entidad | Capy</a> </p>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-630">
			<div id="comment-630" class="comment-body media">
				
					<div class="comment-avartar pull-left">
						<img alt='' src='http://1.gravatar.com/avatar/a46113fb4dd58f319a41662e22151195?s=80&amp;d=identicon&amp;r=g' srcset='http://1.gravatar.com/avatar/a46113fb4dd58f319a41662e22151195?s=160&amp;d=identicon&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' />					</div>
					<div class="comment-context media-body">
						<div class="comment-head">
							<span class="comment-author">Marco</span>							<span class="comment-date">29/04/2014</span>

														<span class="comment-reply">
															</span>
						</div>

						
						<div class="comment-content">
							<p>Ahora un poco mas claro el concepto</p>
						</div>
					</div>
				
			</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="li-comment-631">
			<div id="comment-631" class="comment-body media">
				
					<div class="comment-avartar pull-left">
						<img alt='' src='http://1.gravatar.com/avatar/ddba9ee17446850f50db7c37e01a65f3?s=80&amp;d=identicon&amp;r=g' srcset='http://1.gravatar.com/avatar/ddba9ee17446850f50db7c37e01a65f3?s=160&amp;d=identicon&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' />					</div>
					<div class="comment-context media-body">
						<div class="comment-head">
							<span class="comment-author"><a href='http://realhouses.com.co/' rel='external nofollow' class='url'>Giovanni</a></span>							<span class="comment-date">31/05/2014</span>

														<span class="comment-reply">
															</span>
						</div>

						
						<div class="comment-content">
							<p>Marco era para dejarte un saludo y felicitarte por la facilidad con la que explicas como crear nuestras propias entidades.. Llevo un rato tratando de entender como funciona. Tengo una duda si me puedes ayudar Marco.. Como hago para hacer la parte para editar o agregar contenido a esas entidades..  </p>
<p>De ante manó muchas gracias.</p>
						</div>
					</div>
				
			</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-632">
			<div id="comment-632" class="comment-body media">
				
					<div class="comment-avartar pull-left">
						<img alt='' src='http://0.gravatar.com/avatar/02a4230babd0b973fce95dbb4d52b124?s=80&amp;d=identicon&amp;r=g' srcset='http://0.gravatar.com/avatar/02a4230babd0b973fce95dbb4d52b124?s=160&amp;d=identicon&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' />					</div>
					<div class="comment-context media-body">
						<div class="comment-head">
							<span class="comment-author">Jesús</span>							<span class="comment-date">06/06/2014</span>

														<span class="comment-reply">
															</span>
						</div>

						
						<div class="comment-content">
							<p>Genial,,  muchas gracias</p>
						</div>
					</div>
				
			</div>
		</li><!-- #comment-## -->
        </ul><!-- .comment-list -->

        
                <p class="no-comments">:).</p>
        
    
    </div>                                            
                    
                        
            </div> <!-- #content -->

            <div id="sidebar" class="col-md-3" role="complementary">
                

	<div class="my-profile clearfix">
		<div class="profile-bg">
						<img class="img-responsive" src="../wp-content/uploads/2016/01/14567-brick-wall-and-wood-floor-1920x1200-abstract-wallpaper.jpg">
			
						<div class="profile-img">
				<img class="img-responsive" src="../wp-content/uploads/2016/01/IMG-20150521-WA0007-1.jpg">
			</div>
					</div>

		<div class="profile-desc">
							<h2>Capy (Marcelo Tosco)</h2>
										<span>Desarrollador web</span>
									<p>Hola!. en mi blog casi siempre escribo sobre informática, pero no te extrañes si algún día aparece un post que no tenga nada que ver a lo que estés acostumbrado ;)</p>
					</div>

		
<div class="social-share">
	
	<ul>
		
			
			<li><a class="twitter" href="http://twitter.com/capynet" target="_blank" ><i class="fa fa-twitter"></i></a></li>
									<li><a class="linkedin" href="https://es.linkedin.com/in/capynet" target="_blank"><i class="fa fa-linkedin"></i></a></li>
											 
		
	</ul>
	
</div>




	</div>

                <div class="sidebar-inner">
                    <aside class="widget-area">
                                            </aside>
                </div>
            </div> <!-- #sidebar -->

        </div> <!-- .row -->
    </section> <!-- .container -->


        <footer id="footer">
        <div class="container">
            <div class="footer">
                <div class="row">
                                            <div class="col-sm-6">
                          <a href="http://asociaciondrupal.es/" target="_blank"><img class="alignnone size-full wp-image-3123" src="../wp-content/uploads/2016/01/miembro-aed_150x75.jpg" alt="miembro-aed_150x75" width="150" height="75" /></a>                        </div>
                    
                                    </div>
            </div>
        </div>
    </footer><!--/#footer-->
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-238596-8', 'auto');
  ga('send', 'pageview');

</script>
<link rel='stylesheet' id='crayon-css'  href='../wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min2f6a.css?ver=_2.7.2_beta' type='text/css' media='all' />
<script type='text/javascript' src='../wp-includes/js/imagesloaded.min55a0.js?ver=3.2.0'></script>
<script type='text/javascript' src='../wp-includes/js/masonry.mind617.js?ver=3.3.2'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/bootstrap.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/jquery.prettyPhoto1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/jquery.countdown.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-content/themes/prolog/js/main1c9b.js?ver=4.6.1'></script>
<script type='text/javascript' src='../wp-includes/js/wp-embed.min1c9b.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/ecapy.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Presiona %s para copiar y %s para pegar","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='../wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min2f6a.js?ver=_2.7.2_beta'></script>
</body>

<!-- Mirrored from ecapy.com/entender-y-crear-una-entidad/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Dec 2016 15:38:59 GMT -->
</html>